---

import jsonLDGenerator from "../../utils/json-ld";
import siteData from "../../data/site-data.json";

type Props = {
  // Pass title and description for internal pages
  // If not given, this defaults to site data
  // Url is automatic
  // Robots are optional
  title: string;
  description: string;
  url?: string;
  image?: { src: string; alt: string };
  robots?: boolean;
  keywords?: string[];
  author?: string;
  type?: 'website' | 'article' | 'product' | 'profile';
  publishedTime?: string;
  modifiedTime?: string;
};

const {
  title,
  description,
  url = Astro.url.toString(),
  image,
  robots,
  keywords = siteData.keywords,
  author = siteData.author,
  type = 'website',
  publishedTime,
  modifiedTime,
} = Astro.props;

// Generate JSON-LD structured data
const jsonLD = jsonLDGenerator({
  title,
  description,
  url,
  image: image?.src || siteData.image.src,
  type,
  publishedTime,
  modifiedTime,
});

// Combine default keywords with page-specific ones
const allKeywords = [...new Set([...keywords, ...siteData.keywords])].join(', ');
---

<!-- SEO -->
<link rel="canonical" href={url} />

<!-- Basic Meta Tags -->
<meta name="keywords" content={allKeywords} />
<meta name="author" content={author} />
<meta name="robots" content={robots ? "noindex, nofollow" : "index, follow"} />
<meta name="googlebot" content={robots ? "noindex, nofollow" : "index, follow"} />

<!-- Open Graph -->
<meta property="og:site_name" content={siteData.company.name} />
<meta property="og:title" content={title} />
<meta property="og:description" content={description} />
<meta property="og:url" content={url} />
<meta property="og:type" content={type} />
<meta property="og:image" content={image?.src || siteData.image.src} />
<meta property="og:image:url" content={image?.src || siteData.image.src} />
<meta
  property="og:image:secure_url"
  content={image?.src || siteData.image.src}
/>
<meta property="og:image:type" content="image/jpeg" />
<meta property="og:image:width" content="1200" />
<meta property="og:image:height" content="630" />
<meta property="og:image:alt" content={image?.alt || siteData.image.alt} />
<meta property="og:locale" content="en_US" />

{publishedTime && <meta property="article:published_time" content={publishedTime} />}
{modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}
{author && <meta property="article:author" content={author} />}

<!-- Twitter -->
<meta name="twitter:title" content={title} />
<meta name="twitter:description" content={description} />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:image" content={image?.src || siteData.image.src} />
<meta name="twitter:image:alt" content={image?.alt || title} />
<meta name="twitter:site" content="@litlynx" />
<meta name="twitter:creator" content="@litlynx" />

<!-- Additional SEO Meta Tags -->
<meta name="theme-color" content="#1e40af" />
<meta name="msapplication-TileColor" content="#1e40af" />

<!-- Language and Geographic Targeting -->
<meta name="language" content="English" />
<meta name="geo.region" content="Global" />

<!-- JSON LD -->
<Fragment set:html={jsonLD} />